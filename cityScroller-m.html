<html>
	<head>
		<title>City Scroller</title>
		<script src="http://cloud.github.com/downloads/processing-js/processing-js/processing-1.4.1.min.js"></script>
		<script type="text/processing" data-processing-target="mycanvas">

		//Building testBuilding = new Building(0, random(30,100));
		Skyline firstSkyline = new Skyline();
		//TODO: Create an instance of your Skyline object

        //since these are variables we don't want to ever change in the code, we capitalize them
        var WINDOW_WIDTH = 1000;
        var WINDOW_HEIGHT = 600;
        var GREY = 204;


        //This function only runs once at the start of the program
        void setup() {
          size(WINDOW_WIDTH, WINDOW_HEIGHT); //sets the size of the window
          frameRate(30); //how many times the draw function is called per second
          sl.fillSkyline();
        }

        //called repeatedly
        void draw() {
        	background(GREY); //needed in the draw function to "clear" the screen between updates
					sl.drawSkyline();
					sl.updateAndRefill();
        }


      class Building {
				//attributes
        var x, y, bH, bW, s, bC;

				//constructor
        Building(var xPos, var bW) {
        	bH = random(30,250);
        	bW = buildingWidth;
        	x = 0;
					s = 3;
        	bC = color(255);
        }

      	void drawBuilding(){
          fill(bC);
      		rect(x,(WINDOW_HEIGHT - bH),bW,bH);
      	}

      	void update(){
      		x+=s;
      	}

				int getX(){
					return x;
				}
				int getY(){
					return y;
				}

      }

      class Skyline {
				ArrayList<Building> buildingList;
				var xPos;
				var randomBuildingWidth;

				Skyline(){
					buildingList = new ArrayList<Building>();
					xPos = 0;
					fillSkyline(); //when a Skyline is created it automatically has enough buildings to fill the screen
				}

				void addBuilding(){
					var randomBuildingWidth = random(20,80);
					buildingList.add(new Building(xPos,randomBuildingWidth));
					xPos += randomBuildingWidth;
				}

				void fillSkyline(){ //TODO:add enough buildings to fill the screen
					while(WINDOW_WIDTH > xPos){
						addBuilding();
					}
				}

				void drawSkyline(){
					for(var i = 0; i < buildingList.size(); i++){
						Building currentBuilding = buildingList.get(i);
						currentBuilding.drawBuilding();
					}
				}

				void updateAndRefill(){ //TODO:loop through buildingList and update each Building
					for(var i = 0; i < buildingList.size(); i++){
						Building currentBuilding = buildingList.get(i);
						currentBuilding.update();
					}

					if(xPos > WINDOW_WIDTH - 100){
						addBuilding();
					}

					Building firstBuilding = BuildingList.get(0);
					if(firstBuilding.getX() <= -200){
						BuildingList.remove(0);
					}
				}
			}
        </script>
    </head>

    <body>
		<canvas id="mycanvas"></canvas>
	</body>
</html>
